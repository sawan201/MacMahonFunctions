\include{header}
\newcommand{\Mac}{\mathfrak{M}}
\DeclareMathOperator{\type}{type}
\begin{document}

Let $\Nn$ denote the nonnegative integers and $\Pp$ the positive integers.
Fix $m\in\Pp$ and let $\mathcal{A}=\{x_{i,j} \mid i\in[r],\ j\in\Pp\}$.
Everything that follows takes place in the ring of formal power series $R=\fld[[\mathcal{A}]]$, where $\fld$ is a field (assumed to be of characteristic~0 if necessary).  There is an $\Nn^r$-grading on $R$; the homogeneous component of degree $\uu=(u_1,\dots,u_r)\in\Nn^r$ is the vector space span of monomials having total degree $u_i$ in the variables $\{x_{i,j}\mid j\in\Pp\}$.

The group $\Sym$ of permutations of $\Pp$ acts diagonally on $\mathcal{A}$ by $\sigma(x_{i,j})=x_{i,\sigma(j)}$; this action extends to $R$.  The invariants of the action are the \textbf{MacMahon (symmetric) functions}.  They form a graded subring $\Mac\subseteq R$, with $\Mac_\uu=\Mac\cap R_\uu$.

Following Rosas \cite{Rosas}, the standard combinatorial bases for $\Mac$ are as follows.  For $\uu\in\Nn^r$, each basis for $\Mac_\uu$ is indexed by the \textbf{vector partitions} $\lambda\partn\uu$. Such a thing is a multiset of nonzero vectors $\lambda^{(1)},\dots,\lambda^{(k)}\in\Nn^r$ that sum to $\uu$.

Let $\lambda=\{\lambda^{(1)},\dots,\lambda^{(k)}\}$ be a vector partition, where $\lambda^{(j)}=(\ell_{1,j},\dots,\ell_{r,j})$.
The \textbf{monomial MacMahon function} $m_\lambda$ is the sum of all monomials in the $\Sym$-orbit of the monomial
\[\prod_{j=1}^k \prod_{i=1}^r x_{i,j}^{\ell_{i,j}}.\]
For $\aa=(a_1,\dots,a_r)\in\Nn^r$, the \textbf{power-sum MacMahon function} is
\[p_\aa = \sum_{i=1}^\infty x_{1,i}^{a_1} x_{2,i}^{a_2} \cdots x_{r,i}^{a_r};\]
the \textbf{elementary MacMahon function} is
\[e_\aa = [t_1^{a_1}\cdots t_r^{a_r}] \prod_{i=1}^\infty 1+t_1x_{1,i}+t_2x_{2,i}+\cdots+t_rx_{r,i}\]
and the \textbf{complete homogeneous MacMahon function} is
\[h_\aa = [t_1^{a_1}\cdots t_r^{a_r}] \prod_{i=1}^\infty \frac{1}{1-t_1x_{1,i}-t_2x_{2,i}-\cdots-t_rx_{r,i}}.\]
These are all multiplicative bases:  for a vector partition $\lambda=\{\lambda^{(1)},\dots,\lambda^{(k)}\}$ we set
\[p_\lambda = \prod_{j=1}^k p_{\lambda^{(j)}},\qquad
e_\lambda = \prod_{j=1}^k e_{\lambda^{(j)}},\qquad
h_\lambda = \prod_{j=1}^k h_{\lambda^{(j)}}.\]
Finally, there is an involutive automorphism $\omega\colon\Mac\to\Mac$ defined by $\omega(e_\lambda)=h_\lambda$.
The \textbf{forgotten MacMahon functions} are defined by $f_\lambda=\sign(\lambda)m_\lambda$.

\section{Transitions between bases}

First, a standard linear algebra fact.
Let $V$ be a vector space of finite dimension~$n$ over ground field $\Bbbk$ (it doesn't matter what it is).

\begin{proposition} \label{expansion}
Suppose that $B=\{v_1,\dots,v_n\}$ and $B^*=\{v_1^*,\dots,v_n^*\}$ are bases for $V$ that are orthogonal, i.e.,
\[\langle v_i,v^*_j\rangle=\delta_{ij} k_i\]
for some nonzero constants $k_1,\dots,k_n$.  Then the unique expansion of $u$ with respect to $B$ is
\begin{equation} \label{expand-in-basis}
u = \sum_{i=1}^n \frac{\langle v_i^*,\,u\rangle}{k_i} v_i.
\end{equation}
\end{proposition}

\begin{proof}
For every $j\in[n]$ we have
\[
\left\langle v_j^*,\ \sum_{i=1}^n \frac{\langle v_i^*,\,u\rangle}{k_i} v_i\right\rangle
= \sum_{i=1}^n \frac{\langle v_i^*,\,u\rangle}{k_i} \langle v_j^*,\,v_i\rangle
= \sum_{i=1}^n \langle v_i^*,\,u\rangle \delta_{ij}
= \langle v_j^*,\,u\rangle.\]
That is, every element of $B^*$ has the same inner product with the left and right-hand sides of~\eqref{expand-in-basis}.
This is necessary and sufficient for equality.
\end{proof}

This proposition reduces the problem of expanding a vector in a particular basis $B$ to computing inner products with an orthogonal basis $B^*$.
(The best possible case is that $k_i=1$ for all $i$, i.e., $B^*$ is the dual basis to $B$.  However, we're not always that lucky.)


Notation:
\begin{itemize}
\item $\Nn$ = nonnegative integers
\item For $\uu\in\Nn^k$, a \textbf{vector partition} $\lambda\partn\uu$ is a multiset of nonzero vectors (the \textbf{parts} of $\lambda$) that sum to $u$.
\item Weight of a vector partition = sum of all entries in all vectors in it (ex.: $\wt(\{120,100,100,013\})=9$)
\item $\Mac_\uu$ = MacMahon symmetric functions of homogeneous multidegree $u$
\item $\sign(\lambda)=(-1)^{\text{number of parts with even sum}}$
\item $m_\lambda,e_\lambda,h_\lambda,p_\lambda,f_\lambda$: monomial, elementary, homogeneous, power-sum, and forgotten MacMahon symmetric functions \cite[pp.327--328]{Rosas}
\item For a vector partition $\lambda$ in which each part $v_i$ occurs with multiplicity $m_i$, define
\[|\lambda|=\prod_im_i! \qqandqq \lambda!=\prod_i\prod_{x\in v_i}(x!)^{m_i}.\]
\end{itemize}

A vector partition is \textbf{unitary} if it is a partition of the all-ones vector $\mathbf{1}\in\Nn^k$.  There is an obvious bijection between unitary vector partitions and set partitions of $[k]$.  Unitary MacMahon symmetric functions are the focus of \cite{Doubilet}.  These are the graded pieces $\Mac_{(1)^k}$.

The \textbf{type} of a set partition $\pi=B_1|\cdots|B_\ell$, with respect to a vector $\uu=(u_1,\dots,u_r)$ of weight $n$, is the vector partition $\type_\uu(\pi)=\lambda=\lambda_1\cdots\lambda_\ell$ where $\lambda_k$ is the vector in $\Nn^r$ whose $i$th coordinate is
\[\#\{j\in B_k \mid u_1+\cdots+u_{i-1} < j \leq i_1+\cdots+u_i\}.\]
 the number of elements of $B_k$ such that
in the $i$th equivalence class.

For a vector $\uu$ of weight $n$ and a vector partition $\lambda$ of weight $n$, the number of set partitions $\pi$ of type $\type_\uu(\pi)$ is
\[\binom{\uu}{\lambda} := \frac{\uu!}{\lambda!\,|\lambda|}.\]

Define a scalar product on $\Mac$:
\begin{equation}\label{scalar-product}
\boxed{\scp{h_\lambda}{m_\mu}=\delta_{\lambda\mu}.}
\end{equation}
The idea is to use this for basis transitions, along the lines discussed earlier.  Specifically, formula~\eqref{expand-in-basis} says that for any $F\in\Mac_\uu$, we have
\begin{equation} \label{expand-Mac}
F=\sum_{\lambda\partn u} \langle h_\lambda,\,F\rangle m_\lambda \qqandqq
F=\sum_{\lambda\partn u} \langle m_\lambda,\,F\rangle h_\lambda.
\end{equation}

Thus we have to know how to compute inner products.

There is a ``lifting map'' $\hat\rho$ \cite[Defn.~6]{Rosas} sending MacMahon functions to unitary (Doubilet) symmetric functions.  Specifically:
\begin{subequations}
\begin{align}
\binom{\uu}{\lambda}|\lambda|\,m_\lambda &\overset{\hat\rho}{\longmapsto} \sum_{\pi\colon \type_\uu(\pi)=\lambda} m_\pi \label{liftM}\\
\binom{\uu}{\lambda}\lambda!\,h_\lambda &\overset{\hat\rho}{\longmapsto} \sum_{\pi\colon \type_\uu(\pi)=\lambda} h_\pi\label{liftH}\\
\binom{\uu}{\lambda}\lambda!\,e_\lambda &\overset{\hat\rho}{\longmapsto} \sum_{\pi\colon \type_\uu(\pi)=\lambda} e_\pi\label{liftE}\\
\binom{\uu}{\lambda}\,p_\lambda &\overset{\hat\rho}{\longmapsto} \sum_{\pi\colon \type_\uu(\pi)=\lambda} p_\pi\label{liftP}\\
\binom{\uu}{\lambda}|\lambda|\,f_\lambda &\overset{\hat\rho}{\longmapsto} \sum_{\pi\colon \type_\uu(\pi)=\lambda} f_\pi\label{liftF}
\end{align}
\end{subequations}

Moreover, for all $f,g\in\Mac_\uu$ we have \cite[Prop.~7]{Rosas}
\begin{equation} \label{Rosas-scalar}
\scp{f}{g}=\uu!\scp{\hat\rho(f)}{\hat\rho(g)}
\end{equation}

Prop.~\ref{expansion} together with the scalar product~\eqref{scalar-product} says in particular that for $F\in\Mac_\uu$ we have
\begin{equation} \label{expand-HM}
F = \sum_{\lambda\partn\uu} \langle m_\lambda,\,F\rangle\, h_\lambda,
\qquad\qquad
F = \sum_{\lambda\partn\uu} \langle h_\lambda,\,F\rangle\, m_\lambda.
\end{equation}
Doubilet \cite[Appendix 2]{Doubilet} calculated the scalar products for all five families of unitary symmetric functions (which requires things like lattice operations and  M\"obius and zeta functions in the set partition lattice $\Pi_n$).  Therefore, we should be able to compute scalar products, and thus basis expansions, for all MacMahon functions.  \Red{Warning:} Doubilet's notation for the standard bases is not the usual modern notation (he used $k,a,h,s,f$ for what we call $m,e,h,p,f$ --- perhaps this was not standardized in 1970?), and each of his formulas has an extra $n!$ that needs to be deleted (he was working in an analogous ring where the $n!$ makes sense.  Rosas reproduced Doubilet's calculations (in modern notation and without the $n!$'s that are extraneous in our context).

\section{Expansions in the $m$-basis}

\begin{align*}
p_\mu &=  \uu! \sum_{\lambda\partn\uu} \langle \hat\rho(h_\lambda),\,\hat\rho(p_\mu)\rangle\, m_\lambda
	&&\text{(by~\eqref{expand-Mac} and~\eqref{Rosas-scalar})}\\
&=  \uu! \sum_{\lambda\partn\uu} \left\langle \frac{1}{\binom{\uu}{\lambda}\lambda!} \sum_{\pi\colon \type_\uu(\pi)=\lambda} h_\pi, \ \ \frac{1}{\binom{\uu}{\mu}} \sum_{\sigma\colon \type_\uu(\sigma)=\mu} p_\sigma \right\rangle\, m_\lambda
	&&\text{(by~\eqref{liftH} and~\eqref{liftP})}\\
&=  \frac{\uu!}{\binom{\uu}{\mu}} \sum_{\lambda\partn\uu} \frac{1}{\binom{\uu}{\lambda}\lambda!}
    \sum_{\substack{\pi\colon \type_\uu(\pi)=\lambda\\ \sigma\colon \type_\uu(\sigma)=\mu}}
    \left\langle h_\pi,\,p_\sigma \right\rangle\, m_\lambda
	&&\text{(by bilinearity)}\\
&=  \frac{\uu!}{\binom{\uu}{\mu}} \sum_{\lambda\partn\uu} \frac{1}{\binom{\uu}{\lambda}\lambda!}
    \sum_{\substack{\pi\colon \type_\uu(\pi)=\lambda\\ \sigma\colon \type_\uu(\sigma)=\mu}}
    \zeta(\sigma,\pi) m_\lambda
	&&\text{(by~Doubilet formula \#3)}\\
p_\mu &=  \frac{\uu!}{\binom{\uu}{\mu}} \sum_{\lambda\partn\uu} \frac{\#\{(\pi,\sigma)\mid \type_\uu(\pi)=\lambda,\ \type_\uu(\sigma)=\mu,\ \sigma\leq\pi\}}{\binom{\uu}{\lambda}\lambda!}
    m_\lambda
\end{align*}

\begin{align*}
h_\mu &=  \uu! \sum_{\lambda\partn\uu} \langle \hat\rho(h_\lambda),\,\hat\rho(h_\mu)\rangle\, m_\lambda
	&&\text{(by~\eqref{expand-Mac} and~\eqref{Rosas-scalar})}\\
&=  \uu! \sum_{\lambda\partn\uu} \left\langle \frac{1}{\binom{\uu}{\lambda}\lambda!} \sum_{\pi\colon \type_\uu(\pi)=\lambda} h_\pi, \ \ \frac{1}{\binom{\uu}{\mu}\mu!} \sum_{\sigma\colon \type_\uu(\sigma)=\mu} h_\sigma \right\rangle\, m_\lambda
	&&\text{(by~\eqref{liftH} twice)}\\
&=  \frac{\uu!}{\binom{\uu}{\mu}\mu!} \sum_{\lambda\partn\uu} \frac{1}{\binom{\uu}{\lambda}\lambda!}
    \sum_{\substack{\pi\colon \type_\uu(\pi)=\lambda\\ \sigma\colon \type_\uu(\sigma)=\mu}}
    \left\langle h_\pi,\,h_\sigma \right\rangle\, m_\lambda
	&&\text{(by bilinearity)}\\
&=  \frac{\uu!}{\binom{\uu}{\mu}\mu!} \sum_{\lambda\partn\uu} \frac{1}{\binom{\uu}{\lambda}\lambda!}
    \sum_{\substack{\pi\colon \type_\uu(\pi)=\lambda\\ \sigma\colon \type_\uu(\sigma)=\mu}}
    \lambda(\sigma\meet\pi)!\, m_\lambda
	&&\text{(by Doubilet formula \#9)}\\
\end{align*}

\begin{align*}
e_\mu &=  \uu! \sum_{\lambda\partn\uu} \langle \hat\rho(h_\lambda),\,\hat\rho(e_\mu)\rangle\, m_\lambda
	&&\text{(by~\eqref{expand-Mac} and~\eqref{Rosas-scalar})}\\
&=  \uu! \sum_{\lambda\partn\uu} \left\langle \frac{1}{\binom{\uu}{\lambda}\lambda!} \sum_{\pi\colon \type_\uu(\pi)=\lambda} h_\pi, \ \ \frac{1}{\binom{\uu}{\mu}\mu!} \sum_{\sigma\colon \type_\uu(\sigma)=\mu} e_\sigma \right\rangle\, m_\lambda
	&&\text{(by~\eqref{liftH} and~\eqref{liftE})}\\
&=  \frac{\uu!}{\binom{\uu}{\mu}\mu!} \sum_{\lambda\partn\uu} \frac{1}{\binom{\uu}{\lambda}\lambda!}
    \sum_{\substack{\pi\colon \type_\uu(\pi)=\lambda\\ \sigma\colon \type_\uu(\sigma)=\mu}}
    \left\langle h_\pi,\,e_\sigma \right\rangle\, m_\lambda
	&&\text{(by bilinearity)}\\
&=  \frac{\uu!}{\binom{\uu}{\mu}\mu!} \sum_{\lambda\partn\uu} \frac{\#\{(\pi,\sigma)\mid \type_\uu(\pi)=\lambda,\ \type_\uu(\sigma)=\mu,\ \pi\meet\sigma=\hatzero\}}{\binom{\uu}{\lambda}\lambda!} m_\lambda
	&&\text{(by Doubilet formula \#6)}\\
\end{align*}

\begin{align*}
f_\mu &=  \uu! \sum_{\lambda\partn\uu} \langle \hat\rho(h_\lambda),\,\hat\rho(f_\mu)\rangle\, m_\lambda
	&&\text{(by~\eqref{expand-Mac} and~\eqref{Rosas-scalar})}\\
&=  \uu! \sum_{\lambda\partn\uu} \left\langle \frac{1}{\binom{\uu}{\lambda}\lambda!} \sum_{\pi\colon \type_\uu(\pi)=\lambda} h_\pi, \ \ \frac{1}{\binom{\uu}{\mu}|\mu|} \sum_{\sigma\colon \type_\uu(\sigma)=\mu} f_\sigma \right\rangle\, m_\lambda
	&&\text{(by~\eqref{liftH} and~\eqref{liftP})}\\
&=  \frac{\uu!}{\binom{\uu}{\mu}|\mu|} \sum_{\lambda\partn\uu} \frac{1}{\binom{\uu}{\lambda}\lambda!}
    \sum_{\substack{\pi\colon \type_\uu(\pi)=\lambda\\ \sigma\colon \type_\uu(\sigma)=\mu}}
    \left\langle h_\pi,\,f_\sigma \right\rangle\, m_\lambda
	&&\text{(by bilinearity)}\\
&=  \frac{\uu!}{\binom{\uu}{\mu}|\mu|} \sum_{\lambda\partn\uu} \frac{1}{\binom{\uu}{\lambda}\lambda!}
    \sum_{\substack{\pi\colon \type_\uu(\pi)=\lambda\\ \sigma\colon \type_\uu(\sigma)=\mu\\ \sigma\leq\pi}}
    \lambda(\sigma,\pi)!  m_\lambda
	&&\text{(by Doubilet formula \#13)}\\
\end{align*}

\section{Expansions in the $h$-basis}

\begin{align*}
m_\mu &=  \uu! \sum_{\lambda\partn\uu} \langle \hat\rho(m_\lambda),\,\hat\rho(m_\mu)\rangle\, h_\lambda
	&&\text{(by~\eqref{expand-Mac} and~\eqref{Rosas-scalar})}\\
&= \uu! \sum_{\lambda\partn\uu} \left\langle \frac{1}{\binom{\uu}{\lambda}|\lambda|} \sum_{\pi\colon \type_\uu(\pi)=\lambda} m_\pi, \ \ \frac{1}{\binom{\uu}{\mu}|\mu|} \sum_{\sigma\colon \type_\uu(\sigma)=\mu} m_\sigma \right\rangle\, h_\lambda
	&&\text{(by~\eqref{liftM} twice)}\\
&= \frac{\uu!}{\binom{\uu}{\mu}|\mu|} \sum_{\lambda\partn\uu} \frac{1}{\binom{\uu}{\lambda}|\lambda|}
    \sum_{\substack{\pi\colon \type_\uu(\pi)=\lambda\\ \sigma\colon \type_\uu(\sigma)=\mu}}
    \left\langle m_\pi,\ m_\sigma \right\rangle\, h_\lambda
	&&\text{(by bilinearity)}\\
&= \frac{\uu!}{\binom{\uu}{\mu}|\mu|} \sum_{\lambda\partn\uu} \frac{1}{\binom{\uu}{\lambda}|\lambda|}
    \sum_{\substack{\pi\colon \type_\uu(\pi)=\lambda\\ \sigma\colon \type_\uu(\sigma)=\mu}}
    \sum_{\tau\geq\pi\join\sigma} \frac{\mu(\pi,\tau)\mu(\sigma,\tau)}{\mu(\hatzero,\tau)}\, h_\lambda
	&&\text{(by Doubilet formula \#7)}\\
\end{align*}

\begin{align*}
p_\mu &=  \uu! \sum_{\lambda\partn\uu} \langle \hat\rho(m_\lambda),\,\hat\rho(p_\mu)\rangle\, h_\lambda
	&&\text{(by~\eqref{expand-Mac} and~\eqref{Rosas-scalar})}\\
&=  \uu! \sum_{\lambda\partn\uu} \left\langle \frac{1}{\binom{\uu}{\lambda}|\lambda|} \sum_{\pi\colon \type_\uu(\pi)=\lambda} m_\pi, \ \ \frac{1}{\binom{\uu}{\mu}} \sum_{\sigma\colon \type_\uu(\sigma)=\mu} p_\sigma \right\rangle\, h_\lambda
	&&\text{(by~\eqref{liftM} and~\eqref{liftP})}\\
&= \frac{\uu!}{\binom{\uu}{\mu}} \sum_{\lambda\partn\uu} \frac{1}{\binom{\uu}{\lambda}|\lambda|}
    \sum_{\substack{\pi\colon \type_\uu(\pi)=\lambda\\ \sigma\colon \type_\uu(\sigma)=\mu}}
    \left\langle m_\pi,\ p_\sigma \right\rangle\, h_\lambda
	&&\text{(by bilinearity)}\\
&= \frac{\uu!}{\binom{\uu}{\mu}} \sum_{\lambda\partn\uu} \frac{1}{\binom{\uu}{\lambda}|\lambda|}
    \sum_{\substack{\pi\colon \type_\uu(\pi)=\lambda\\ \sigma\colon \type_\uu(\sigma)=\mu\\ \pi\leq\sigma}}
    \frac{\mu(\pi,\sigma)}{|\mu(\hatzero,\sigma)|}\, h_\lambda
	&&\text{(by Doubilet formula \#10)}\\
\end{align*}

\begin{align*}
e_\mu &=  \uu! \sum_{\lambda\partn\uu} \langle \hat\rho(m_\lambda),\,\hat\rho(e_\mu)\rangle\, h_\lambda
	&&\text{(by~\eqref{expand-Mac} and~\eqref{Rosas-scalar})}\\
&=  \uu! \sum_{\lambda\partn\uu} \left\langle \frac{1}{\binom{\uu}{\lambda}|\lambda|} \sum_{\pi\colon \type_\uu(\pi)=\lambda} m_\pi, \ \ \frac{1}{\binom{\uu}{\mu}\mu!} \sum_{\sigma\colon \type_\uu(\sigma)=\mu} e_\sigma \right\rangle\, h_\lambda
	&&\text{(by~\eqref{liftM} and~\eqref{liftE})}\\
&= \frac{\uu!}{\binom{\uu}{\mu}\mu!} \sum_{\lambda\partn\uu} \frac{1}{\binom{\uu}{\lambda}|\lambda|}
    \sum_{\substack{\pi\colon \type_\uu(\pi)=\lambda\\ \sigma\colon \type_\uu(\sigma)=\mu}}
    \left\langle m_\pi,\ e_\sigma \right\rangle\, h_\lambda
	&&\text{(by bilinearity)}\\
&= \frac{\uu!}{\binom{\uu}{\mu}\mu!} \sum_{\lambda\partn\uu} \frac{1}{\binom{\uu}{\lambda}|\lambda|}
    \sum_{\substack{\pi\colon \type_\uu(\pi)=\lambda\\ \sigma\colon \type_\uu(\sigma)=\mu\\ \pi\leq\sigma}}
    \sign(\pi) \lambda(\pi,\sigma)!\, h_\lambda
	&&\text{(by Doubilet formula \#8)}\\
\end{align*}

\begin{align*}
f_\mu &=  \uu! \sum_{\lambda\partn\uu} \langle \hat\rho(m_\lambda),\,\hat\rho(f_\mu)\rangle\, h_\lambda
	&&\text{(by~\eqref{expand-Mac} and~\eqref{Rosas-scalar})}\\
&=  \uu! \sum_{\lambda\partn\uu} \left\langle \frac{1}{\binom{\uu}{\lambda}|\lambda|} \sum_{\pi\colon \type_\uu(\pi)=\lambda} m_\pi, \ \ \frac{1}{\binom{\uu}{\mu}|\mu|} \sum_{\sigma\colon \type_\uu(\sigma)=\mu} f_\sigma \right\rangle\, h_\lambda
	&&\text{(by~\eqref{liftM} and~\eqref{liftF})}\\
&= \frac{\uu!}{\binom{\uu}{\mu}|\mu|} \sum_{\lambda\partn\uu} \frac{1}{\binom{\uu}{\lambda}|\lambda|}
    \sum_{\substack{\pi\colon \type_\uu(\pi)=\lambda\\ \sigma\colon \type_\uu(\sigma)=\mu}}
    \left\langle m_\pi,\ f_\sigma \right\rangle\, h_\lambda
	&&\text{(by bilinearity)}\\
&= \frac{\uu!}{\binom{\uu}{\mu}|\mu|} \sum_{\lambda\partn\uu} \frac{1}{\binom{\uu}{\lambda}|\lambda|}
    \sum_{\substack{\pi\colon \type_\uu(\pi)=\lambda\\ \sigma\colon \type_\uu(\sigma)=\mu}}
    \sum_{\tau\geq\sigma\join\pi} \frac{|\mu(\sigma,\tau)|\cdot\mu(\pi,\tau)}{\mu(\hatzero,\tau)}\, h_\lambda
	&&\text{(by Doubilet formula \#11)}\\
\end{align*}

\section{Expansions in the $p$-basis}

Rosas \cite[p.333]{Rosas} states that for $\lambda\partn\uu$,
\begin{equation}
\langle p_\lambda,\,p_\mu \rangle = \frac{\delta_{\lambda,\mu}|\lambda|\,\lambda!}{|\mu(\hatzero,\lambda)|}
\end{equation}
where $\mu(\hatzero,\lambda)$ means $\mu(\hatzero,\pi)$ for any set partition $\pi$ such that $\type_u(\pi)=\lambda$.  This can be verified using the lifting maps and Doubilet's formula.
% Verification:
%\begin{align*}
%\scp{p_\lambda}{p_\mu}
%&= \uu!\scp{\hat\rho(p_\lambda)}{\hat\rho(p_\mu)}
%	&&\text{(by~\eqref{Rosas-scalar})}\\
%&=  \frac{\uu!}{\binom{\uu}{\lambda}\binom{\uu}{\mu}}   \sum_{\substack{\pi\colon \type_\uu(\pi)=\lambda\\ \sigma\colon \type_\uu(\sigma)=\mu}}
% \scp{p_\pi}{p_\sigma}
%	&&\text{(by~\eqref{liftP} and bilinearity)}\\
%&=  \frac{\uu!}{\binom{\uu}{\lambda}\binom{\uu}{\mu}}   \sum_{\substack{\pi\colon \type_\uu(\pi)=\lambda\\ \sigma\colon \type_\uu(\sigma)=\mu}}
%\frac{\delta_{\pi,\sigma}}{|\mu(\hatzero,\pi)|}
%	&&\text{(by Doubilet formula \#2)}
%&= \frac{\delta_{\lambda,\mu} \uu!}{\binom{\uu}{\lambda}^2}   \sum_{\pi\colon \type_\uu(\pi)=\lambda}
%\frac{1}{|\mu(\hatzero,\pi)|}\\
%&= \frac{\delta_{\lambda,\mu} \uu!}{\binom{\uu}{\lambda}^2} \frac{\binom{\uu}{\lambda}}{|\mu(\hatzero,\lambda)|}
%= \frac{\delta_{\lambda,\mu} \uu!}{\binom{\uu}{\lambda}|\mu(\hatzero,\lambda)|}
%= \frac{\delta_{\lambda,\mu} |\lambda| \lambda!}{|\mu(\hatzero,\lambda)|}
%\end{align*}

Therefore, Proposition~\ref{expansion} says that for every $F\in\Mac$,
\begin{equation} \label{expand-in-P-basis}
F = \sum_\lambda \frac{\langle p_\lambda,\,F\rangle |\mu(\hatzero,\lambda)|}{|\lambda|\,\lambda!} p_\lambda
= \sum_\lambda \frac{\langle p_\lambda,\,F\rangle |\mu(\hatzero,\lambda)| \binom{\uu}{\lambda}}{\uu!} p_\lambda
\end{equation}
So, as before:

\begin{align*}
m_\mu &= \sum_\lambda \left\langle \binom{\uu}{\lambda}\hat\rho(p_\lambda),\,\hat\rho(m_\mu)\right\rangle |\mu(\hatzero,\lambda)|  p_\lambda
	&&\text{(by~\eqref{expand-in-P-basis} and~\eqref{Rosas-scalar})}\\
&= \frac{1}{\binom{\uu}{\mu}|\mu|} \sum_\lambda |\mu(\hatzero,\lambda)| \sum_{\substack{\sigma\colon \type_\uu(\sigma)=\lambda\\ \pi\colon \type_\uu(\pi)=\mu}} \left\langle p_\sigma,\, m_\pi\right\rangle  p_\lambda
	&&\text{(by~\eqref{liftP} and~\eqref{liftM} and bilinearity)}\\
&= \frac{1}{\binom{\uu}{\mu}|\mu|} \sum_\lambda\left[ |\mu(\hatzero,\lambda)| \sum_{\substack{\sigma\colon \type_\uu(\sigma)=\lambda\\ \pi\colon \type_\uu(\pi)=\mu\\ \pi\leq\sigma}} \frac{\mu(\pi,\sigma)}{|\mu(\hatzero,\sigma)|} \right] p_\lambda
	&&\text{(by Doubilet formula \#10)}\\
\end{align*}

\begin{align*}
h_\mu &= \sum_\lambda \langle \hat\rho(p_\lambda),\,\hat\rho(h_\mu)\rangle |\mu(\hatzero,\lambda)| \binom{\uu}{\lambda} p_\lambda
	&&\text{(by~\eqref{expand-in-P-basis} and~\eqref{Rosas-scalar})}\\
&= \frac{1}{\binom{\uu}{\mu} \mu!} \sum_\lambda |\mu(\hatzero,\lambda)| \sum_{\substack{\sigma\colon \type_\uu(\sigma)=\lambda\\ \pi\colon \type_\uu(\pi)=\mu}} \left\langle p_\sigma,\, h_\pi\right\rangle  p_\lambda
	&&\text{(by~\eqref{liftP} and~\eqref{liftH} and bilinearity)}\\
&= \frac{1}{\binom{\uu}{\mu} \mu!} \sum_\lambda\left[ |\mu(\hatzero,\lambda)| \sum_{\substack{\sigma\colon \type_\uu(\sigma)=\lambda\\ \pi\colon \type_\uu(\pi)=\mu\\ \sigma\leq\pi}} \right] p_\lambda
	&&\text{(by Doubilet formula \#3)}\\
\end{align*}

\begin{align*}
e_\mu &= \sum_\lambda \langle \hat\rho(p_\lambda),\,\hat\rho(e_\mu)\rangle |\mu(\hatzero,\lambda)| \binom{\uu}{\lambda} p_\lambda
	&&\text{(by~\eqref{expand-in-P-basis} and~\eqref{Rosas-scalar})}\\
&= \frac{1}{\binom{\uu}{\mu} \mu!} \sum_\lambda |\mu(\hatzero,\lambda)| \sum_{\substack{\sigma\colon \type_\uu(\sigma)=\lambda\\ \pi\colon \type_\uu(\pi)=\mu}} \left\langle p_\sigma,\, e_\pi\right\rangle  p_\lambda
	&&\text{(by~\eqref{liftP} and~\eqref{liftE} and bilinearity)}\\
&= \frac{1}{\binom{\uu}{\mu} \mu!} \sum_\lambda\left[ |\mu(\hatzero,\lambda)| \sum_{\substack{\sigma\colon \type_\uu(\sigma)=\lambda\\ \pi\colon \type_\uu(\pi)=\mu\\ \sigma\leq\pi}} \sign(\sigma) \right] p_\lambda
	&&\text{(by Doubilet formula \#4)}\\
\end{align*}

\begin{align*}
f_\mu &= \sum_\lambda \langle \hat\rho(p_\lambda),\,\hat\rho(f_\mu)\rangle |\mu(\hatzero,\lambda)| \binom{\uu}{\lambda} p_\lambda
	&&\text{(by~\eqref{expand-in-P-basis} and~\eqref{Rosas-scalar})}\\
&= \frac{1}{\binom{\uu}{\mu}|\mu|} \sum_\lambda |\mu(\hatzero,\lambda)| \sum_{\substack{\sigma\colon \type_\uu(\sigma)=\lambda\\ \pi\colon \type_\uu(\pi)=\mu}} \left\langle p_\sigma,\, f_\pi\right\rangle  p_\lambda
	&&\text{(by~\eqref{liftP} and~\eqref{liftF} and bilinearity)}\\
&= \frac{1}{\binom{\uu}{\mu}|\mu|} \sum_\lambda\left[ |\mu(\hatzero,\lambda)| \sum_{\substack{\sigma\colon \type_\uu(\sigma)=\lambda\\ \pi\colon \type_\uu(\pi)=\mu\\ \pi\leq\sigma}}\sign(\pi)\sign(\sigma)\frac{\mu(\pi,\sigma)}{|\mu(\hatzero,\sigma)|} \right] p_\lambda
	&&\text{(by Doubilet formula \#14)}\\
\end{align*}

\section{The omega involution, and expansions in the $e$- and $f$-bases}

There is an automorphism $\omega\colon\Mac\to\Mac$ (called $\theta$ in \cite{Doubilet}) defined by
\[\omega(e_\lambda) = h_\lambda\]
This is defined in \cite[p.328]{Rosas} (and used to define the forgotten basis $f_\lambda=\sign(\lambda)\omega(m_\lambda)$).
I would like to know what $\omega$ does to $p_\lambda$.  For symmetric functions, we have $\omega(p_\lambda)=\sign(\lambda) p_\lambda$ (where $\lambda$ is a partition), and for unitary MacMahon functions, we have $\omega(p_\pi)=\sign(\pi) p_\pi$ (where $\pi$ is a set partition).  It would be natural to hope that $\omega(p_\lambda)=\sign(\lambda) p_\lambda$ in general, though Rosas does not state that.  Can we prove it?  And can we prove that $\omega$ is an isometry?

Or should we just assume all of these things?  If so, then applying $\omega$ to the conversions to the $h$-basis gives

\begin{align*}
f_\mu &= \sign(\mu) \frac{\uu!}{\binom{\uu}{\mu}|\mu|} \sum_{\lambda\partn\uu} \frac{1}{\binom{\uu}{\lambda}|\lambda|}
    \sum_{\substack{\pi\colon \type_\uu(\pi)=\lambda\\ \sigma\colon \type_\uu(\sigma)=\mu}}
    \sum_{\tau\geq\pi\join\sigma} \frac{\mu(\pi,\tau)\mu(\sigma,\tau)}{\mu(\hatzero,\tau)}\, e_\lambda
\end{align*}

\begin{align*}
p_\mu &= \sign(\mu) \frac{\uu!}{\binom{\uu}{\mu}} \sum_{\lambda\partn\uu} \frac{1}{\binom{\uu}{\lambda}|\lambda|}
    \sum_{\substack{\pi\colon \type_\uu(\pi)=\lambda\\ \sigma\colon \type_\uu(\sigma)=\mu\\ \pi\leq\sigma}}
    \frac{\mu(\pi,\sigma)}{|\mu(\hatzero,\sigma)|}\, e_\lambda
\end{align*}

\begin{align*}
h_\mu &= \frac{\uu!}{\binom{\uu}{\mu}\mu!} \sum_{\lambda\partn\uu} \frac{1}{\binom{\uu}{\lambda}|\lambda|}
    \sum_{\substack{\pi\colon \type_\uu(\pi)=\lambda\\ \sigma\colon \type_\uu(\sigma)=\mu\\ \pi\leq\sigma}}
    \sign(\pi) \lambda(\pi,\sigma)!\, e_\lambda
\end{align*}

\begin{align*}
m_\mu &= \sign(\mu) \frac{\uu!}{\binom{\uu}{\mu}|\mu|} \sum_{\lambda\partn\uu} \frac{1}{\binom{\uu}{\lambda}|\lambda|}
    \sum_{\substack{\pi\colon \type_\uu(\pi)=\lambda\\ \sigma\colon \type_\uu(\sigma)=\mu}}
    \sum_{\tau\geq\sigma\join\pi} \frac{|\mu(\sigma,\tau)|\cdot\mu(\pi,\tau)}{\mu(\hatzero,\tau)}\, e_\lambda
\end{align*}

and likewise applying $\omega$ to the conversions to the $m$-basis gives

\begin{align*}
p_\mu &= \sign(\mu)  \frac{\uu!}{\binom{\uu}{\mu}} \sum_{\lambda\partn\uu} \sign(\lambda) \frac{\#\{(\pi,\sigma)\mid \type_\uu(\pi)=\lambda,\ \type_\uu(\sigma)=\mu,\ \sigma\leq\pi\}}{\binom{\uu}{\lambda}\lambda!}
    f_\lambda
\end{align*}

\begin{align*}
e_\mu &= \frac{\uu!}{\binom{\uu}{\mu}\mu!} \sum_{\lambda\partn\uu} \sign(\lambda) \frac{1}{\binom{\uu}{\lambda}\lambda!}
    \sum_{\substack{\pi\colon \type_\uu(\pi)=\lambda\\ \sigma\colon \type_\uu(\sigma)=\mu}}
    \lambda(\sigma\meet\pi)!\, f_\lambda
\end{align*}

\begin{align*}
h_\mu &=  \frac{\uu!}{\binom{\uu}{\mu}\mu!} \sum_{\lambda\partn\uu} \sign(\lambda) \frac{\#\{(\pi,\sigma)\mid \type_\uu(\pi)=\lambda,\ \type_\uu(\sigma)=\mu,\ \pi\meet\sigma=\hatzero\}}{\binom{\uu}{\lambda}\lambda!} f_\lambda
\end{align*}

\begin{align*}
m_\mu &= \sign(\mu)  \frac{\uu!}{\binom{\uu}{\mu}|\mu|} \sum_{\lambda\partn\uu} \sign(\lambda) \frac{1}{\binom{\uu}{\lambda}\lambda!}
    \sum_{\substack{\pi\colon \type_\uu(\pi)=\lambda\\ \sigma\colon \type_\uu(\sigma)=\mu\\ \sigma\leq\pi}}
    \lambda(\sigma,\pi)!  f_\lambda
\end{align*}


\bibliographystyle{amsalpha}
\bibliography{MacMahon}
\end{document}